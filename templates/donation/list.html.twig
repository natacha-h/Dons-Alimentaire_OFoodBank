{% extends 'base.html.twig' %}

{% block title %}liste des dons{% endblock %}

{% block picture_header %}{% endblock %}

{% block body %}

<h2 class="text-center my-3">Liste des dons</h2>

{# J'ajoute un tri par catégorie #}
<p>Trier par catégorie</p>

{# ici il faut charger le formulaire de tri => inclure un template tierce#}
{{ include('donation/_form-categories.html.twig') }}

{% if is_granted('ROLE_GIVER') %}
<div class="row justify-content-center">
    <a href="{{path('donation_new')}}" class="btn btn-success">Nouveau Don</a>
</div>
{% endif %} 

<div class="row mt-3">
    {% for donation in donations %}
        <div class="col-md-6 col-12 my-2">
            <div class="card h-100">
                <div class="card-body">
                    {# {{ asset('uploads/pictures/' ~ donation.picture) }} #}
                    <img src="{{ asset('uploads/pictures/' ~ donation.picture) }}" class="card-img regul-size" alt="image du don">
                    
                    <h3 class="card-title">
                        {{donation.title}}
                        {% if "Dispo" == donation.status.name %}
                            <img class="mainpoper" src="{{asset('pictures/status_dispo.png')}} " alt="Don disponible">
                            <div class="subpoper">Ce don est disponible</div>
                        {% elseif "Réservé" == donation.status.name %}
                            <img class="mainpoper" src="{{asset('pictures/status_reserve.png')}} " alt="Don déjà réservé">                         
                            <div class="subpoper">Ce don est réservé</div>
                        {% endif %}
                    </h3>
                    <p class="card-text">Crée le {{donation.createdAt|date("d/m/Y")}}</p>
                    <p class="card-text">À {{donation.address.city}} ({{donation.address.zipcode}})</p>
                    {% if expiryDateArray[donation.id] is defined %}
                        <p class="card-text">Date de péremption : {{ expiryDateArray[donation.id]|date("d/m/Y") }}</p>
                    {% endif %}
                    <a href="{{path('donation_show', {'id': donation.id})}}" class="btn btn-primary">Plus d'infos</a>
                </div>
            </div>
        </div>

    {% endfor %}
</div>


<div class="pagination col-md-5 mx-auto mt-4">
    {{ knp_pagination_render(donations) }}
</div>
{% endblock %}

